PhyloWGS/witness
================

Description
-----------
Witness is used to view and help interpret the results output by PhyloWGS. It makes use of the json files output by write_results.py and reports information of interest in a browser friendly format. Refer to steps 4 and 5 in the PhyloWGS README for how to generate these json files and how to run witness.

Files Output by write_results.py
--------------------------------
These are the files loaded by witness. If you wish to do your own visualizations or analysis, these files are a good place to start. Below is a brief description of these files. To see all information contained in these json files, open them in a json friendly application (if you are unsure of what application to use, note that Firefox works as a good reader).
  - run.summ.json: this file contains tree summary information. In this file one can find tree structure, likelihood of that tree explaining the data, cellular prevalence of subclonal populations, tree clustering information, etc. 
  - run.muts.json: this file contains the ssm and cnv information input to evolve.py. 
  - run.mutass.zip: This zip file contains a json file for every tree. Every file contains which mutations have been assigned to each node in that particular tree.

Interpreting Witness
--------------------
Upon opening witness and selecting a run, you will see two tabs for viewing results, "Tree summaries" and "Tree viewer".

Tree summaries: here you will see information that relates to all of the trees generated by PhyloWGS.
  1) First displayed is a histogram of SSMs over their VAFs. For single sample runs this can be informative as it can be possible to pick out individual subpopulations. For multisample runs the VAFs are calculated by taking the mean across samples. In that case this histogram is less useful. In the future we will add functionality to better compare values across samples.
  2) A table summarizing tree cluster information.
  3) A scatter plot of tree structure indexes with ellipses drawn to indicate clusters. See the "Description of Reported Values" section below for more information on the indexes.
  4) Histograms of cellular prevalence for specific nodes across trees.
  5) Histograms of SSM frequency for specific nodes across trees.
  6) Histogram of number of cancerous populations across trees.

Tree viewer: here you will see information for each individual tree constructed by PhyloWGS. 
  1) In the center of the page will be reported the structure of a tree, how the cancer cell fraction (CCF) changes from sample to sample, and a table providing additional information for each node in the tree. 
  2) On the right side of the screen you can select which tree you wish to view, and information such as nlgLH, number of nodes, which cluster this tree is a member of, LI (linearity index), BI (branching index), and CI (clustering index). 

Description of Reported Values
------------------------------
- LI (linearity index): shows what proportion of mutations are in linear relations -- i.e., given mutations A and B, they're linear if A is in a population ancestral to B, or vice versa.
- BI (branching index): shows what proportion of mutation pairs occur in different branches of the tree.
- CI (clustering index): shows what proportion of mutation pairs are placed in the same cluster (i.e., population).
- Note: These indexes give a good indication for the overall structure of a tree and are used to cluster the trees together into structurally distinct groups. They are defined such that LI+BI+CI=1.
- nlgLH (normalized log likelihood). The lower this value, the better the tree fits the given data. The tree with lowest nlgLH is often considered to be the "best tree". Though keep in mind that it is important to consider the other trees reported by PhyloWGS, because while they may not be the "best", the other trees could certainly explain the true phylogeny.

